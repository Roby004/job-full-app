import{w as N}from"./with-props-CxWoRmkF.js";import{r as c,t as B,x as S,n as e,q as y}from"./chunk-LSOULM7L-io0bedPh.js";import{N as k}from"./navbar-cli-CwZoKeuF.js";import{B as l}from"./Box-B5QIj5Xy.js";import{T as n}from"./Typography-Dl5m69Yi.js";import{B as A}from"./Button-BcTfHBKO.js";import{S as E}from"./Stack-DJ672RKg.js";import{G as O}from"./Grid-D586BZFi.js";import{M as T}from"./Popover-ehDyiyj2.js";import"./logo-icon2-3sguuZSz.js";import"./Menu-CfqzC8Vj.js";import"./DefaultPropsProvider-D3XoZZZR.js";import"./Grow-3Z0qnTTb.js";import"./index-CNVCymyq.js";import"./useTheme-BGXANyoT.js";import"./createSimplePaletteValueFilter-Ci2NaAvL.js";import"./MenuItem-DE46lkXZ.js";import"./ButtonBase-AlovMshM.js";import"./isFocusVisible-B8k4qzLc.js";import"./listItemTextClasses-CxOMZ5Ha.js";import"./CircularProgress-jWFtDqlA.js";import"./createSvgIcon-Czy4a_wd.js";import"./useThemeProps-4GIH6D68.js";import"./isMuiElement-bxpgwgQD.js";const J="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGXSURBVHgBzVVLUsJAEH0TKHCpN4g3iCcwVPlhKTeQE6AnUU4AN8Cln4XxBM4ROIJLscq0PZ8wIWSGZGHBq0ol6enP6zc9CXBIiJJrUlerGPwztgskw1hfbeGJE1WnCPSuHnOIAeTzEg2T++K2OrACxwK0QENEyJVvXLc53Y03rkzJcMA8FgQaG3bpcYTehCBSbje1JCQnnf7Kt7lhTWMBMWOfUbVrgRBc67HHY7lLyuAUFcnJJsqxOsnli2DGI2VTa9qHu0TbAp3k8rZITlidMcsMMvvSi/L1Sdlckd5d6wKs58Tc6X6duAy2sc/Y+p778uhNLp9OJYF5EknBFl58S6CvNjItElRz7T7JAX1rO6ugu8nagWlkZiyPVCdZXXAnuboh4ytRYl328XbAB+3DONCstgu2sfYPhoyY+vJ4C+T4eXRT0v8Es3XJL1Jts1PGEzZvXcBOycAVEQsX1FmfD+WDALqhRf3pAE6F5x9gzkd4o8OfCgvfT6ZuOLZi0QBWpp22vaCRRApVmZrIo+PQEGVJDkYehT9Dv7VF7EGuBwAAAABJRU5ErkJggg==",R={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",borderRadius:2,boxShadow:24,p:4,textAlign:"center"};function b(d){try{const t=d.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),p=decodeURIComponent(atob(t).split("").map(function(m){return"%"+("00"+m.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(p)}catch{return null}}const P=()=>{var f;const[d,i]=c.useState(!1),[t,p]=c.useState(null),[m,U]=c.useState([]);B();const{id:x}=S(),[h,j]=c.useState(null),v=()=>i(!0),w=async s=>{try{const r=localStorage.getItem("token"),o=b(r);if(!o||!o.user_id){console.error("Utilisateur non connecté ou token invalide.");return}const a=JSON.parse(localStorage.getItem("candidatePreferences")),g=await fetch("http://localhost:5000/matching",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({user_id:o.user_id,offer:s,preferences:a})}),u=await g.json();g.ok?(j(u.matching_score),console.log("Matching réussi:",u)):console.error("Erreur matching:",u)}catch(r){console.error("Erreur réseau lors du matching:",r)}},C=async()=>{const s=localStorage.getItem("token"),r=b(s);if(!r||!r.user_id){alert("Utilisateur non connecté ou token invalide.");return}try{const o=await fetch("http://localhost:5000/application",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({name:t.title,job_offer_id:t.id,status:"en attente"})});console.log("Offer title:",t.title),console.log("Offer title:",t.id),console.log("Offer user title:",r.user_id),console.log("response:",o);const a=await o.json();o.ok?(alert("Votre candidature a été enregistrée avec succès !"),i(!1)):(console.error(a),alert(a.error||"Une erreur s'est produite lors de la candidature."))}catch(o){console.error(o),alert("Erreur réseau : impossible d’envoyer la candidature.")}i(!1)};return c.useEffect(()=>{x&&(async()=>{try{const r=localStorage.getItem("token"),o=await fetch(`http://localhost:5000/offer/${x}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!o.ok)throw new Error("Unauthorized");const a=await o.json();console.log("Offer data get:",a),a&&a.id&&(p(a),w(a))}catch(r){console.error("Erreur lors du chargement de l'offre :",r)}})()},[x]),t?e.jsxs("div",{className:"min-h-screen bg-gray-100 px-8 py-6 pt-2",style:{fontFamily:"Open Sans",marginTop:"0px"},children:[e.jsx(k,{}),e.jsxs(y,{to:"/employe/accueil",className:"flex flex-row max-w-4xl mx-50 p-6 mt-0 text-[#929c9f] font-semibold hover:underline my-4",children:["← Retour aux offres |",e.jsxs("span",{className:"text-[#023047] flex flex-row gap-4",children:[" ",t.title," ",e.jsx("img",{src:J})," "]}),"  "]}),e.jsxs("div",{className:"max-w-4xl mx-auto p-6 mt-6 font-sans text-gray-800 bg-white rounded-lg shadow-md flex flex-row",children:[e.jsxs("div",{className:"lside ml-10",style:{width:"70%",minWidth:"50%"},children:[e.jsx("h1",{className:"text-2xl font-bold text-[#023047]",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[(f=t.company)==null?void 0:f.name," · ",t.location]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Description de l'offre"}),e.jsxs("p",{className:"text-gray-700 mt-2",children:[" ",t.description]})]}),e.jsxs(l,{sx:{mr:2,mt:4},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",py:1,borderBottom:"1px solid #dadada",borderRadius:"4px",padding:"10px"},children:[e.jsx(n,{variant:"body2",children:"Télétravail ou présentiel"}),e.jsx(n,{variant:"body2",children:t.mode_travail})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",py:1,borderBottom:"1px solid #dadada",borderRadius:"4px",padding:"10px"},children:[e.jsx(n,{variant:"body2",children:"Type de contrat"}),e.jsx(n,{variant:"body2",children:t.type_offre})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",py:1,borderBottom:"1px solid #dadada",borderRadius:"4px",padding:"10px"},children:[e.jsx(n,{variant:"body2",children:"Fourchette de salaire"}),e.jsxs(n,{variant:"body2",children:[t.salaire,"€"]})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",py:1,borderBottom:"1px solid #dadada",borderRadius:"4px",padding:"10px"},children:[e.jsx(n,{variant:"body2",children:"Catégorie"}),e.jsx(n,{variant:"body2",children:t.category})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Compétences"}),e.jsx("div",{className:"flex flex-wrap gap-3 mt-2",children:t.skills_required&&t.skills_required.length>0?t.skills_required.map((s,r)=>e.jsx("span",{className:"bg-[#fff1cc] text-[#c79202] px-3 py-1 rounded-full text-sm font-medium",children:s.name},r)):e.jsx("span",{className:"text-gray-500",children:"Aucune compétences spécifiques requises"})})]}),e.jsx(A,{variant:"contained",onClick:v,className:"mt-8",sx:{marginTop:"20px",backgroundColor:"#023047",color:"white","&:hover":{backgroundColor:"#45a049"}},children:"Postuler"})]}),e.jsx("div",{id:"rside",children:e.jsxs(E,{spacing:2,className:"bg-white p-4 rounded shadow-md",children:[e.jsxs(O,{container:!0,spacing:2,sx:{display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"#f6f8f9",padding:"20px",borderRadius:"10px"},children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Matching"}),e.jsx("p",{className:"text-gray-700 mt-2",children:"cet offre, correspond à votre profil de : "}),e.jsx("p",{className:"text-gray-700 mt-2 py-4",style:{backgroundColor:"#0a8051",alignItems:"center",background:"linear-gradient(264.79deg, #206EBB 47.52%,  #BAA3EC 126.2%)",borderRadius:"40px",fontSize:"24px",color:"white",width:"100%",textAlign:"center"},children:h!==null?`${h}%`:"Chargement..."})]}),e.jsx("h2",{className:"text-lg font-semibold",children:"Similar Jobs"}),e.jsx("ul",{className:"list-disc ml-5 text-gray-700 mt-2",children:(m||[]).map(s=>e.jsx("li",{children:e.jsx(y,{to:`/employe/jobDetail/${s.id}`,className:"text-blue-600 hover:underline",children:s.title})},s.id))})]})})]}),e.jsx(T,{open:d,onClose:()=>i(!1),"aria-labelledby":"modal-title",children:e.jsxs(l,{sx:R,children:[e.jsx(n,{id:"modal-title",variant:"h6",component:"h2",gutterBottom:!0,children:"En postulant vous acceptez de donner votre accord pour que le recruteur puisse accéder à votre profil et vous contacter."}),e.jsx(A,{onClick:C,variant:"contained",color:"primary",sx:{mt:2},children:"Procéder"})]})})]}):e.jsx("div",{className:"p-8",children:"Job not found"})},ne=N(P);export{ne as default};
